{% extends 'base.html' %}
{% load static %}

{% block title %}Cangaro Multimarcas - Detalhes do Carro{% endblock %}

{% block extra_css %}
{{ block.super }}
<link rel="stylesheet" href="{% static 'css/detalhes_carros.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% endblock %}

{% block content %}

<!-- Carregar as template tags personalizadas -->
{% load custom_filters %}

<div class="car-detail-container">
  <!-- Link para voltar √† lista de carros -->
  <a href="{% url 'lista_carros' %}" class="btn btn-back">
    <i class="fas fa-arrow-left"></i> Voltar para a Lista
  </a>

  <div class="car-card">
    <div class="car-image">
      <!-- Imagem do carro vinda do backend -->
      {% if carro.foto %}
      <img src="{{ carro.foto.url }}" alt="{{ carro.marca }} {{ carro.modelo }}">
      {% else %}
      <div class="no-image">üöó Imagem n√£o dispon√≠vel</div>
      {% endif %}
    </div>

    <div class="car-info">
      <!-- T√≠tulo com marca e modelo do carro -->
      <h1 class="car-title">{{ carro.marca }} {{ carro.modelo }}</h1>

      <div class="car-details-grid">
        <!-- Detalhes do carro vindos do backend -->
        <div class="detail-item">
          <span class="detail-label">Ano de Fabrica√ß√£o</span>
          <span class="detail-value">{{ carro.ano_fabricacao|default:"N√£o informado" }}</span>
        </div>

        <div class="detail-item">
          <span class="detail-label">Ano do Modelo</span>
          <span class="detail-value">{{ carro.ano_modelo|default:"N√£o informado" }}</span>
        </div>

        <div class="detail-item">
          <span class="detail-label">Placa</span>
          <span class="detail-value">{{ carro.placa|default:"N√£o informada" }}</span>
        </div>

        <div class="detail-item">
          <span class="detail-label">Quilometragem</span>
          <span class="detail-value">
            {% if carro.km %}
            {{ carro.km|format_km }} km
            {% else %}
            N√£o informada
            {% endif %}
          </span>
        </div>

        <div class="detail-item">
          <span class="detail-label">Combust√≠vel</span>
          <span class="detail-value">{{ carro.combustivel|default:"N√£o informado" }}</span>
        </div>

        <div class="detail-item">
          <span class="detail-label">C√¢mbio</span>
          <span class="detail-value">{{ carro.cambio|default:"N√£o informado" }}</span>
        </div>

        <div class="detail-item">
          <span class="detail-label">Cor</span>
          <span class="detail-value">{{ carro.cor|default:"N√£o informada" }}</span>
        </div>

        <div class="detail-item">
          <span class="detail-label">Portas</span>
          <span class="detail-value">{{ carro.portas|default:"N√£o informadas" }}</span>
        </div>
      </div>

      <!-- Pre√ßo do carro formatado com o filtro personalizado -->
      <div class="car-price">R$ {{ carro.valor|format_currency }}</div>
    </div>
  </div>

  <div class="buttons-container">
    <a href="https://wa.me/5584991473506" class="btn btn-primary" target="_blank">
      <i class="fas fa-phone"></i> Entrar em Contato
    </a>

    <!-- Bot√£o de Editar - vis√≠vel apenas para usu√°rios logados -->
    {% if user.is_authenticated %}
    <a href="{% url 'atualizar_carro' pk=object.id %}" class="btn btn-warning">
      <i class="fas fa-edit"></i> Editar Carro
    </a>
    {% endif %}

    <button class="btn btn-danger" id="favorite-btn">
      <i class="fas fa-heart"></i> Adicionar aos Favoritos
    </button>
  </div>
</div>

<script src="{% static 'js/detalhes_carros.js' %}"></script>
{% endblock %}